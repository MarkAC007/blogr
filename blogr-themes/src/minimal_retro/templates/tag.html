{% extends "base.html" %}

{% block title %}Tag: {{ tag }} - {{ config.blog.title }}{% endblock %}

{% block meta %}
<meta name="description" content="Posts tagged with {{ tag }} on {{ config.blog.title }}">
{% endblock %}

{% block content %}
<div class="tag-page">
    <header class="tag-header">
        <h1 class="tag-title">Posts tagged with <span class="tag-name">#{{ tag }}</span></h1>
        <p class="tag-subtitle">{{ posts | length }} post{{ posts | length | pluralize }} found</p>
    </header>

    {% if posts %}
        <div class="tag-posts">
            {% for post in posts %}
            <article class="tag-post">
                <div class="post-date">
                    <time datetime="{{ post.date }}">
                        {{ post.date | date(format="%b %d, %Y") }}
                    </time>
                </div>

                <div class="post-content">
                    <h2 class="post-title">
                        <a href="/posts/{{ post.slug }}">{{ post.title }}</a>
                    </h2>

                    {% if post.description %}
                    <p class="post-description">{{ post.description }}</p>
                    {% endif %}

                    <div class="post-meta">
                        {% if config.theme.config.show_author and post.author %}
                        <span class="post-author">by {{ post.author }}</span>
                        {% endif %}

                        {% if config.theme.config.show_reading_time and post.reading_time %}
                        <span class="reading-time">{{ post.reading_time }} min read</span>
                        {% endif %}

                        {% if post.status == "draft" %}
                        <span class="draft-badge">Draft</span>
                        {% endif %}
                    </div>

                    {% if post.tags and post.tags | length > 1 %}
                    <div class="post-tags">
                        <span class="tags-label">Other tags:</span>
                        {% for post_tag in post.tags %}
                            {% if post_tag != tag %}
                            <a href="/tags/{{ post_tag | slugify }}" class="tag">#{{ post_tag }}</a>
                            {% endif %}
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </article>
            {% endfor %}
        </div>

        <div class="tag-pagination">
            <!-- Future enhancement: Add pagination if needed -->
        </div>
    {% else %}
        <div class="no-posts">
            <p>No posts found with the tag "{{ tag }}".</p>
            <p class="no-posts-hint">Try browsing <a href="/tags">all available tags</a> or go back to the <a href="/">homepage</a>.</p>
        </div>
    {% endif %}

    <div class="tag-navigation">
        <a href="/tags" class="back-tags">← All Tags</a>
        <a href="/archive" class="view-archive">View Archive →</a>
    </div>

    <aside class="related-tags">
        {% if all_tags and all_tags | length > 1 %}
        <h3 class="related-title">Other Tags</h3>
        <div class="tags-cloud">
            {% for other_tag in all_tags %}
                {% if other_tag.name != tag %}
                <a href="/tags/{{ other_tag.name | slugify }}" class="tag-cloud-item"
                   style="font-size: {{ other_tag.count | times: 0.8 | plus: 1.0 }}em;">
                    #{{ other_tag.name }} ({{ other_tag.count }})
                </a>
                {% endif %}
            {% endfor %}
        </div>
        {% endif %}
    </aside>
</div>
{% endblock %}
